from xlrd import open_workbook      
import xlwt 
from xlutils.copy import copy

book = open_workbook("api_calls.xls")
wb=copy(book)
w_sheet=wb.get_sheet(0)



my_file = "output.txt"


def countt():
    infile = open(my_file,"r")
    numlines=0
  
    for line in infile:
        numlines=numlines+1
       
        if line.count(my_string):
            for sheet in book.sheets():
                for rowidx in range(sheet.nrows):
                    row = sheet.row(rowidx)
                    for colidx,cell in enumerate(row):
                        if cell.value == my_string:
                            w_sheet.write(1,colidx, my_string)
                          
                            wb.save("api_calls.xls")
                            break
    infile.close
    
my_string = "transact"
countt()
my_string = "onServiceConnected"
countt()
my_string = "bindService"
countt()
my_string = "attachInterface"
countt()
my_string = "android.os.Binder"
countt()
my_string = "Ljava.lang.Class.getCanonicalName"
countt()
my_string = "Ljava.lang.Class.getMethods"
countt()
my_string = "Ljava.lang.Class.cast"
countt()
my_string = "Ljava.net.URLDecoder"
countt()
my_string = "android.content.pm.Signature"
countt()
my_string = "android.telephony.SmsManager"
countt()
my_string = "getBinder"
countt()
my_string = "ClassLoader"
countt()
my_string = "Landroid.content.Context.registerReceiver"
countt()

my_string = "Ljava.lang.Class.getField"
countt()
my_string = "Landroid.content.Context.unregisterReceiver"
countt()
my_string = "Ljava.lang.Class.getDeclaredField"
countt()
my_string = "getCallingUid"
countt()
my_string = "Ljavax.crypto.spec.SecretKeySpec"
countt()
my_string = "android.content.pm.PackageInfo"
countt()
my_string = "KeySpec"
countt()
my_string = "TelephonyManager.getLine1Number"
countt()
my_string = "DexClassLoader"
countt()
my_string = "HttpGet.init"
countt()
my_string = "SecretKey"
countt()
my_string = "Ljava.lang.Class.getMethod"
countt()
my_string = "System.loadLibrary"
countt()
my_string = "android.intent.action.SEND"
countt()
my_string = "Ljavax.crypto.Cipher"
countt()
my_string = "android.telephony.gsm.SmsManager"
countt()
my_string = "TelephonyManager.getSubscriberId"
countt()
my_string = "Runtime.getRuntime"
countt()
my_string = "Ljava.lang.Object.getClass"
countt()
my_string = "Ljava.lang.Class.forName"
countt()
my_string = "Binder"
countt()
my_string = "IBinder"
countt()
my_string = "android.os.IBinder"
countt()
my_string = "createSubprocess"
countt()
my_string = "URLClassLoader"
countt()
my_string = "abortBroadcast"
countt()
my_string = "TelephonyManager.getDeviceId"
countt()
my_string = "Ljava.lang.Class.getPackage"
countt()
my_string = "PathClassLoader"
countt()
my_string = "TelephonyManager.getSimSerialNumber"
countt()
my_string = "Runtime.load"
countt()
my_string = "TelephonyManager.getCallState"
countt()
my_string = "TelephonyManager.getSimCountryIso"
countt()
my_string = "sendMultipartTextMessage"
countt()
my_string = "PackageInstaller"
countt()
my_string = "sendDataMessage"
countt()
my_string = "HttpPost.init"
countt()
my_string = "Ljava.lang.Class.getClasses"
countt()
my_string = "TelephonyManager.isNetworkRoaming"
countt()
my_string = "HttpUriRequest"
countt()
my_string = "divideMessage"
countt()
my_string = "Runtime.exec"
countt()
my_string = "TelephonyManager.getNetworkOperator"
countt()
my_string = "IRemoteService"
countt()
my_string = "SET_ALARM"
countt()
my_string = "ACCOUNT_MANAGER"
countt()
my_string = "TelephonyManager.getSimOperator"
countt()
my_string = "onBind"
countt()
my_string = "Process.start"
countt()
my_string = "Context.bindService"
countt()
my_string = "ProcessBuilder"
countt()
my_string = "Ljava.lang.Class.getResource"
countt()
my_string = "defineClass"
countt()
my_string = "findClass"
countt()
my_string = "Runtime.loadLibrary"
countt()

















